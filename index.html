<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Squarespace Recipe Generator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Removed external CSS link to keep everything self-contained -->
    <style>
        body {
            margin: 0;
            font-family: 'Arial', sans-serif;
            background: #f4f4f4;
            color: #000;
        }
        .container {
            max-width: 1000px;
            margin: 20px auto;
            padding: 20px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        header h1 {
            margin: 0;
            color: #000;
            font-size: 2.2rem;
        }
        header h1 i {
            color: #000;
        }
        .subtitle {
            color: #555;
            font-style: italic;
            font-size: 1.1rem;
        }
        .app-container {
            display: flex;
            gap: 20px;
        }
        .form-section {
            flex: 1;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
        }
        .preview-section {
            flex: 1;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #000;
        }
        input[type="text"], textarea, input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1rem;
            color: #000;
        }
        textarea {
            height: 100px;
            resize: vertical;
        }
        .list-item {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }
        .list-item input {
            flex: 1;
        }
        .btn {
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        .btn-add {
            background: #000;
            color: white;
        }
        .btn-remove {
            background: #666;
            color: white;
        }
        /* Clean Black & White Code Output */
        #code-output {
            background: white;
            color: #000;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            white-space: pre-wrap;
            word-break: break-all;
            min-height: 150px;
            max-height: 250px;
            overflow-y: auto;
            margin-bottom: 15px;
            line-height: 1.3;
        }
        .actions {
            display: flex;
            gap: 10px;
        }
        .btn-generate {
            background: #000;
            color: white;
            flex: 1;
        }
        .btn-copy {
            background: #555;
            color: white;
            flex: 1;
        }
        footer {
            text-align: center;
            margin-top: 40px;
            color: #666;
            font-size: 0.9rem;
        }
        .notification {
            position: fixed;
            top: 20px;
            right: -300px;
            background: #000;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transition: right 0.3s ease;
            z-index: 1000;
            font-size: 0.95rem;
        }
        .notification.show {
            right: 20px;
        }
    </style>
</head>
<body>
<div class="container">
    <header>
        <h1><i class="fas fa-utensils"></i> Squarespace Recipe Generator</h1>
        <p class="subtitle">Create elegant, professional recipes for your Squarespace site</p>
    </header>
    <div class="app-container">
        <div class="form-section">
            <h2>Recipe Details</h2>
            <div class="form-group">
                <label for="recipe-title">Recipe Title</label>
                <input type="text" id="recipe-title" placeholder="e.g., Classic Chocolate Chip Cookies" value="Herb-Crusted Rack of Lamb">
            </div>
            <div class="form-group">
                <label for="recipe-description">Description</label>
                <textarea id="recipe-description" placeholder="A brief description of your recipe...">A sophisticated dish featuring tender lamb coated in a fragrant herb crust, served with a rich red wine reduction. Perfect for special occasions.</textarea>
            </div>
            <div class="form-group">
                <label for="prep-time">Prep Time (minutes)</label>
                <input type="number" id="prep-time" placeholder="e.g., 15" value="25">
            </div>
            <div class="form-group">
                <label for="cook-time">Cook Time (minutes)</label>
                <input type="number" id="cook-time" placeholder="e.g., 12" value="35">
            </div>
            <div class="form-group">
                <label for="servings">Servings</label>
                <input type="number" id="servings" placeholder="e.g., 4" value="4">
            </div>
            <h2>Ingredients</h2>
            <ul id="ingredients-list">
                <li class="list-item">
                    <input type="text" value="2 racks of lamb (8 bones each), frenched">
                    <button class="btn btn-remove" onclick="removeItem(this)"><i class="fas fa-times"></i></button>
                </li>
                <li class="list-item">
                    <input type="text" value="3 tablespoons Dijon mustard">
                    <button class="btn btn-remove" onclick="removeItem(this)"><i class="fas fa-times"></i></button>
                </li>
                <li class="list-item">
                    <input type="text" value="2 tablespoons fresh rosemary, finely chopped">
                    <button class="btn btn-remove" onclick="removeItem(this)"><i class="fas fa-times"></i></button>
                </li>
                <li class="list-item">
                    <input type="text" value="2 tablespoons fresh thyme leaves">
                    <button class="btn btn-remove" onclick="removeItem(this)"><i class="fas fa-times"></i></button>
                </li>
            </ul>
            <button class="btn btn-add" onclick="addItem('ingredients')">Add Ingredient</button>
            <h2>Instructions</h2>
            <ul id="instructions-list">
                <li class="list-item">
                    <input type="text" value="Preheat oven to 425Â°F. Season lamb generously with salt and pepper.">
                    <button class="btn btn-remove" onclick="removeItem(this)"><i class="fas fa-times"></i></button>
                </li>
                <li class="list-item">
                    <input type="text" value="Heat olive oil in an oven-safe skillet over high heat. Sear lamb racks on all sides until golden brown.">
                    <button class="btn btn-remove" onclick="removeItem(this)"><i class="fas fa-times"></i></button>
                </li>
                <li class="list-item">
                    <input type="text" value="Brush the top of each rack with Dijon mustard.">
                    <button class="btn btn-remove" onclick="removeItem(this)"><i class="fas fa-times"></i></button>
                </li>
            </ul>
            <button class="btn btn-add" onclick="addItem('instructions')">Add Instruction</button>
            <h2>Tips</h2>
            <ul id="tips-list">
                <li class="list-item">
                    <input type="text" value="Let the lamb reach room temperature before cooking">
                    <button class="btn btn-remove" onclick="removeItem(this)"><i class="fas fa-times"></i></button>
                </li>
                <li class="list-item">
                    <input type="text" value="Use a meat thermometer for perfect doneness">
                    <button class="btn btn-remove" onclick="removeItem(this)"><i class="fas fa-times"></i></button>
                </li>
            </ul>
            <button class="btn btn-add" onclick="addItem('tips')">Add Tip</button>
        </div>
        <div class="preview-section">
            <h2>Generated Code</h2>
            <p>Copy the code below and paste it into a Squarespace Code Block:</p>
            <div id="code-output">Click "Generate Code" to create your Squarespace recipe block.</div>
            <div class="actions">
                <button class="btn btn-generate" onclick="generateCode()">Generate Code</button>
                <button class="btn btn-copy" onclick="copyCode()">Copy to Clipboard</button>
            </div>
        </div>
    </div>
    <footer>
        <p>Made with <i class="fas fa-heart" style="color: #000;"></i> for Culinary Professionals</p>
    </footer>
</div>
<div class="notification" id="notification">Code copied to clipboard!</div>

<script>
    function addItem(type) {
        const list = document.getElementById(type + '-list');
        const newItem = document.createElement('li');
        newItem.className = 'list-item';
        let placeholder = '';
        if (type === 'ingredients') placeholder = 'e.g., 2 cups all-purpose flour';
        else if (type === 'instructions') placeholder = 'e.g., Mix ingredients together';
        else if (type === 'tips') placeholder = 'e.g., Pro tip for better results';
        newItem.innerHTML = `
            <input type="text" placeholder="${placeholder}">
            <button class="btn btn-remove" onclick="removeItem(this)"><i class="fas fa-times"></i></button>
        `;
        list.appendChild(newItem);
    }

    function removeItem(button) {
        const item = button.closest('li');
        const list = item.parentNode;
        if (list.children.length > 1) {
            item.remove();
        } else {
            item.querySelector('input').value = '';
        }
    }

    function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

function generateCode() {
    const title = document.getElementById('recipe-title').value || 'Delicious Recipe';
    const description = document.getElementById('recipe-description').value || 'A wonderful recipe to try.';
    const prepTime = document.getElementById('prep-time').value || '15';
    const cookTime = document.getElementById('cook-time').value || '30';
    const servings = document.getElementById('servings').value || '4';

    const ingredients = Array.from(document.querySelectorAll('#ingredients-list input'))
        .map(input => input.value.trim())
        .filter(value => value);

    const instructions = Array.from(document.querySelectorAll('#instructions-list input'))
        .map(input => input.value.trim())
        .filter(value => value);

    const tips = Array.from(document.querySelectorAll('#tips-list input'))
        .map(input => input.value.trim())
        .filter(value => value);

    const recipeId = 'recipe-' + Date.now();

    // Fraction â†” Decimal mapping
    const fractionToDecimal = {
        'Â¼': 0.25, 'Â½': 0.5, 'Â¾': 0.75,
        'â…“': 0.33, 'â…”': 0.67,
        '1/4': 0.25, '1/2': 0.5, '3/4': 0.75,
        '1/3': 0.33, '2/3': 0.67
    };

    function usToMetric(text) {
        return text
            .replace(/(\d*\.?\d+|[Â¼Â½Â¾â…“â…”]|[\\d\\/]+)\s*cup(?:s)?/gi, (match, qty) => {
                const value = fractionToDecimal[qty] || eval(qty.replace('/', '/')) || 1;
                return Math.round(value * 240) + ' ml';
            })
            .replace(/(\d*\.?\d+|[Â¼Â½Â¾â…“â…”]|[\\d\\/]+)\s*(tablespoon|tbsp)/gi, (match, qty, unit) => {
                const value = fractionToDecimal[qty] || eval(qty.replace('/', '/')) || 1;
                return Math.round(value * 15) + ' ml';
            })
            .replace(/(\d*\.?\d+|[Â¼Â½Â¾â…“â…”]|[\\d\\/]+)\s*(teaspoon|tsp)/gi, (match, qty, unit) => {
                const value = fractionToDecimal[qty] || eval(qty.replace('/', '/')) || 1;
                return Math.round(value * 5) + ' ml';
            })
            .replace(/(\d*\.?\d+|[Â¼Â½Â¾â…“â…”]|[\\d\\/]+)\s*(ounce|oz)/gi, (match, qty, unit) => {
                const value = fractionToDecimal[qty] || eval(qty.replace('/', '/')) || 1;
                return Math.round(value * 28) + ' grams';
            })
            .replace(/(\d*\.?\d+|[Â¼Â½Â¾â…“â…”]|[\\d\\/]+)\s*(pound|lb)/gi, (match, qty, unit) => {
                const value = fractionToDecimal[qty] || eval(qty.replace('/', '/')) || 1;
                return Math.round(value * 454) + ' grams';
            })
            .replace(/(\d+)Â°F/g, (match, f) => {
                const c = (parseFloat(f) - 32) * 5 / 9;
                return Math.round(c / 5) * 5 + 'Â°C';
            });
    }

    function metricToUs(text) {
        return text
            .replace(/(\d+)\s*ml/g, (match, ml) => {
                const volume = parseFloat(ml);
                const cups = volume / 240;
                if (cups >= 0.25) {
                    const fraction = toFraction(cups);
                    if (fraction) return fraction + ' cup';
                    return cups.toFixed(2).replace(/\.00$/, '') + ' cup';
                } else if (volume % 15 === 0 && volume <= 30) {
                    const tbsp = volume / 15;
                    return tbsp === 1 ? '1 tablespoon' : tbsp + ' tablespoons';
                } else if (volume % 5 === 0 && volume <= 15) {
                    const tsp = volume / 5;
                    return tsp === 1 ? '1 teaspoon' : tsp + ' teaspoons';
                }
                return match;
            })
            .replace(/(\d+)\s*grams/g, (match, g) => {
                const weight = parseFloat(g);
                if (weight < 454) {
                    const oz = weight / 28;
                    const fraction = toFraction(oz);
                    if (fraction) return fraction + ' oz';
                    return oz.toFixed(1).replace(/\.0$/, '') + ' oz';
                } else {
                    const lb = weight / 454;
                    return lb.toFixed(1).replace(/\.0$/, '') + ' lb';
                }
            })
            .replace(/(\d+)Â°C/g, (match, c) => {
                const f = (parseFloat(c) * 9 / 5) + 32;
                return Math.round(f / 5) * 5 + 'Â°F';
            });
    }

    // Generate both versions
    const ingredientsUs = ingredients;
    const ingredientsMetric = ingredients.map(usToMetric);

    const instructionsUs = instructions;
    const instructionsMetric = instructions.map(usToMetric);

    // Unique ID for checkbox
    const checkboxId = `unit-toggle-${Date.now()}`;

    let code = `
<!-- Recipe with Unit Toggle -->
<style>
    .recipe-container {
        font-family: 'Georgia', serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 30px;
        background: #ffffff;
        border: 2px solid #000000;
        box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    }
    .unit-toggle-switch {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 20px;
        font-size: 0.9rem;
    }
    .unit-toggle-switch label {
        display: flex;
        align-items: center;
        cursor: pointer;
    }
    .switch {
        position: relative;
        width: 50px;
        height: 24px;
        background: #ccc;
        border-radius: 12px;
        margin: 0 10px;
        transition: background 0.3s;
    }
    .switch::before {
        content: '';
        position: absolute;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        top: 2px;
        left: 2px;
        background: white;
        transition: transform 0.3s;
    }
    #${checkboxId}:checked ~ .recipe-container .switch {
        background: #000;
    }
    #${checkboxId}:checked ~ .recipe-container .switch::before {
        transform: translateX(26px);
    }
    .us-unit, .metric-unit {
        display: inline;
    }
    #${checkboxId} {
        display: none;
    }
    #${checkboxId}:checked ~ .recipe-container .us-unit {
        display: none;
    }
    #${checkboxId}:not(:checked) ~ .recipe-container .metric-unit {
        display: none;
    }
</style>

<input type="checkbox" id="${checkboxId}" style="display:none;">
<label for="${checkboxId}" class="unit-toggle-switch">
    <span>US Units</span>
    <div class="switch"></div>
    <span>Metric Units</span>
</label>

<div class="recipe-container" id="${recipeId}">
  <h1 style="font-family: 'Playfair Display', serif; color: #000000; text-align: center; margin-bottom: 15px; font-size: 2.4rem; font-weight: 700;">${escapeHtml(title)}</h1>
  <p style="text-align: center; color: #333333; font-style: italic; margin-bottom: 30px; font-size: 1.1rem; line-height: 1.6;">${escapeHtml(description)}</p>
  <div style="display: flex; justify-content: space-around; flex-wrap: wrap; margin-bottom: 35px; border-top: 2px solid #000000; border-bottom: 2px solid #000000; padding: 20px 0;">
    <div style="text-align: center; padding: 18px;">
      <div style="font-weight: 600; color: #000000; font-size: 1rem; letter-spacing: 1px;">PREP TIME</div>
      <div style="font-size: 1.3rem; font-weight: 500; margin-top: 5px; color: #333333;">${prepTime} mins</div>
    </div>
    <div style="text-align: center; padding: 18px;">
      <div style="font-weight: 600; color: #000000; font-size: 1rem; letter-spacing: 1px;">COOK TIME</div>
      <div style="font-size: 1.3rem; font-weight: 500; margin-top: 5px; color: #333333;">${cookTime} mins</div>
    </div>
    <div style="text-align: center; padding: 18px;">
      <div style="font-weight: 600; color: #000000; font-size: 1rem; letter-spacing: 1px;">SERVINGS</div>
      <div style="font-size: 1.3rem; font-weight: 500; margin-top: 5px; color: #333333;">${servings}</div>
    </div>
  </div>
  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-bottom: 30px;">
    <div class="ingredients-section">
      <h2 style="color: #000000; border-bottom: 3px solid #000000; padding-bottom: 8px; margin-bottom: 20px; font-size: 1.8rem; font-weight: 600;">
        Ingredients
      </h2>
      <ul class="ingredients-list" style="list-style-type: none; padding-left: 0;">`;

    ingredientsUs.forEach((us, i) => {
        const metric = ingredientsMetric[i];
        code += `
        <li style="margin-bottom: 12px; padding-left: 25px; position: relative; font-size: 1.05rem; color: #333333; line-height: 1.5;">
          <span style="position: absolute; left: 0; top: 0; color: #000000; font-size: 1.2rem; font-weight: bold;">â€¢</span>
          <span class="us-unit">${escapeHtml(us)}</span>
          <span class="metric-unit">${escapeHtml(metric)}</span>
        </li>`;
    });

    code += `
      </ul>
    </div>
    <div class="instructions-section">
      <h2 style="color: #000000; border-bottom: 3px solid #000000; padding-bottom: 8px; margin-bottom: 20px; font-size: 1.8rem; font-weight: 600;">
        Instructions
      </h2>
      <ol class="instructions-list" style="padding-left: 25px; font-size: 1.05rem; color: #333333;">`;

    instructionsUs.forEach((us, i) => {
        const metric = instructionsMetric[i];
        code += `
        <li style="margin-bottom: 18px; padding-left: 8px; line-height: 1.6;">
          <span class="us-unit">${escapeHtml(us)}</span>
          <span class="metric-unit">${escapeHtml(metric)}</span>
        </li>`;
    });

    code += `
      </ol>
    </div>
  </div>`;

    if (tips.length > 0) {
        code += `
  <div style="margin-bottom: 30px; border-top: 2px solid #000000; padding-top: 25px;">
    <h2 style="color: #000000; border-bottom: 3px solid #000000; padding-bottom: 8px; margin-bottom: 20px; font-size: 1.8rem; font-weight: 600;">Chef's Tips</h2>
    <ul style="list-style-type: none; padding-left: 0; font-size: 1.05rem; color: #333333;">`;

        tips.forEach(tip => {
            code += `
      <li style="margin-bottom: 12px; padding-left: 25px; position: relative; line-height: 1.6;">
        <span style="position: absolute; left: 0; top: 0; color: #000000; font-size: 1.2rem;">ðŸ’¡</span> ${escapeHtml(tip)}
      </li>`;
        });

        code += `
    </ul>
  </div>`;
    }

    code += `
</div>
<!-- End Recipe -->`;

    document.getElementById('code-output').textContent = code;
}

    function copyCode() {
        const codeOutput = document.getElementById('code-output');
        const text = codeOutput.textContent;
        if (navigator.clipboard) {
            navigator.clipboard.writeText(text).then(showNotification).catch(fallbackCopy);
        } else {
            fallbackCopy(text);
        }
    }

    function fallbackCopy(text) {
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        showNotification();
    }

    function showNotification() {
        const notification = document.getElementById('notification');
        notification.classList.add('show');
        setTimeout(() => {
            notification.classList.remove('show');
        }, 3000);
    }

    // Generate code on load
    document.addEventListener('DOMContentLoaded', () => {
        setTimeout(generateCode, 500);
    });
</script>
</body>
</html>